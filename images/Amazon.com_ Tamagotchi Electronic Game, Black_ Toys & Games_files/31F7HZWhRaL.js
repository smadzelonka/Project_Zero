(function(d){var g=window.AmazonUIPageJS||window.P,r=g._namespace||g.attributeErrors,e=r?r("PageRefreshAsset",""):g;e.guardFatal?e.guardFatal(d)(e,window):e.execute(function(){d(e,window)})})(function(d,g,r){d.when("A","page-refresh-state","web-ajax-utility","alt-page-refresh-measurement","state-aware-feature-consolidator","page-refresh-utils","dp-interactive-page-refresh-handler").register("page-refresh-handler",function(e,h,n,c,b,f,a){var k={},q=e.$,l={},t="",p,d=function(k,h,g,d,x){var m=this;
m.clientId=k;m.clientName=h.toLowerCase();m.doPageRefresh=function(c,f,h){var p,d;d="";p=c["Non-Persistent"];p.hasOwnProperty("triggerEvent")&&(d=p.triggerEvent);if(void 0!==d&&""!==d&&" "!==d){p=b.getStateAwareParameters();var m;l=q.extend(!0,l,c.Persistent);r();d=e.copy(t);q.extend(!0,d,l,c["Non-Persistent"],p);c=g;p=e.contains(c,"?");c+=p?"\x26":"?";d=w(d);for(m in d)if(null!=d[m]){p=d[m];var v=c.slice(-1);c+="?"===v||"\x26"===v?"":"\x26";c+=m+"\x3d"+p}m=c;a.createInteractivityObjectForTwisterUpdate();
n.getInstance(k,m,f,h,x).getContent()}else throw"triggerEvent parameter missing or invalid";};m.addParams=function(a){l=q.extend(!0,l,a);return!0};m.removeParams=function(a){e.each(a,function(a,c){delete l[a];delete t[a]});return!0};m.createCustomParamsMap=function(a,c){var b={Persistent:{},"Non-Persistent":{}};q.each(a,function(a,c){b.Persistent[a]=c});q.each(c,function(a,c){b["Non-Persistent"][a]=c});return b};m.startMeasurement=function(a,c,b,k,f,e){this.pageRefreshMeasurement&&this.pageRefreshMeasurement.start(a,
c,b,k,f,e)};m.stampImageLoad=function(a){this.pageRefreshMeasurement&&this.pageRefreshMeasurement.stampImageLoad(a)};m.stampFeature=function(a,c){this.pageRefreshMeasurement&&this.pageRefreshMeasurement.stampFeature(a,c)};m.fadeInFeatures=function(a){"undefined"!==typeof a&&a.length||(a=p[m.clientName]);f.fadeInFeatures(a)};var r=function(){q.each(t,function(a,c){l.hasOwnProperty(a)&&(t[a]=l[a])})},w=function(a){var c={},b=Object.keys(a);b.sort();q.each(b,function(b,k){c[k]=a[k]});return c};(function(){if(d){var a=
d.config;m.pageRefreshMeasurement=new c(q,a.atf.marker,a.cf.marker);m.pageRefreshMeasurement.init(d.storeID,d.productGroupID,d.triggerEvent)}})()};(function(){var a=h.fetchPageRefreshData();t=a.pageRefreshUrlParams;p=a.divToUpdateData})();return{getHandlerInstance:function(a,c,b,f){(null==a||""===a)&&g.ueLogError&&g.ueLogError({message:"Invalid ClientId"},{logLevel:"FATAL",attribution:"PageRefreshAPI",message:"Invalid ClientId passed to getHandlerInstance of dpRefreshHandler"});k[a]||(k[a]=new d(a,
c,b,f));return k[a]},getPersistentParams:function(){return l}}});"use strict";d.when("A","page-refresh-handler").register("dp-refresh-handler",function(e,h){function n(c,b,f,a){this.featureTriggeringRefresh=c.featureName;this.deviceTypeStateData=e.state("detail-page-device-type");"undefined"===typeof this.deviceTypeStateData&&(this.deviceTypeStateData=e.state("page-refresh-device-type"));this.deviceType=this.deviceTypeStateData&&this.deviceTypeStateData.deviceType?this.deviceTypeStateData.deviceType:
"web";this.pageRefreshUrl=f&&f.pageRefreshUrl?f.pageRefreshUrl:"/gp/page/refresh";this.clientId="PageRefresh_"+this.deviceType+"_"+this.featureTriggeringRefresh+"_Client";this.DPRefreshHandler=h.getHandlerInstance(this.clientId,this.featureTriggeringRefresh,this.pageRefreshUrl,b,a)}n.prototype={doPageRefresh:function(c,b,f){try{this.DPRefreshHandler.doPageRefresh(c,b,f)}catch(a){g.ueLogError&&g.ueLogError(a,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the doPageRefresh method triggered by - "+
this.featureTriggeringRefresh+": "+a})}},createCustomParamsMap:function(c,b){var f={};try{f=this.DPRefreshHandler.createCustomParamsMap(c,b)}catch(a){g.ueLogError&&g.ueLogError(a,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the createCustomParamsMap method triggered by - "+this.featureTriggeringRefresh+": "+a})}return f},addParams:function(c){return c&&"object"==typeof c?this.DPRefreshHandler.addParams(c):!1},removeParams:function(c){return c&&"object"==
typeof c?this.DPRefreshHandler.removeParams(c):!1},startMeasurement:function(c,b,f,a,k,e){try{this.DPRefreshHandler.startMeasurement(c,b,f,a,k,e)}catch(h){g.ueLogError&&g.ueLogError(h,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the startMeasurement method triggered by - "+this.featureTriggeringRefresh+": "+h})}},stampImageLoad:function(c){try{this.DPRefreshHandler.stampImageLoad(c)}catch(b){g.ueLogError&&g.ueLogError(b,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,
message:"This error is caused by the startMeasurement method triggered by - "+this.featureTriggeringRefresh+": "+b})}},stampFeature:function(c,b){try{this.DPRefreshHandler.stampFeature(c,b)}catch(f){g.ueLogError&&g.ueLogError(f,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the startMeasurement method triggered by - "+this.featureTriggeringRefresh+": "+f})}},fadeInFeatures:function(c){try{this.DPRefreshHandler.fadeInFeatures(c)}catch(b){g.ueLogError&&
g.ueLogError(b,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the fadeInFeatures method triggered by - "+this.featureTriggeringRefresh+": "+b})}}};return n});d.when("A","jQuery","dp-interactive-page-refresh-handler","dp-click-to-ci-utils").register("alt-page-refresh-ajax-scope",function(e,h,n,c){return function(b,f,a,k,h){this.scopeName=f;this.url=a;this.customPageTypeId=k;this.customTags=h;this.requestIdAvailable=!1;ues("t0",f,g.newTwisterInteractionStartTime);
ues("ctb",f,"1");this.signalMarker=function(a){!this.markers[a]||0>=this.markers[a].conditions||0===--this.markers[a].conditions&&"function"==typeof this.markers[a].handler&&this.markers[a].handler()};this.addlongPoleTag=function(a,c){a=a.toLowerCase();this.markers[a]&&0==this.markers[a].conditions&&0==this.markers[a].conditions&&g.ue&&"function"===typeof ue.tag&&ue.tag(c)};this.markClickToCI=function(){var a=this,b=n.getClickToCIMetric();b&&b.then(function(b){uet("fn",a.scopeName,void 0,b.interactiveTime);
a.requestIdAvailable&&uex("ld",lScopeName);c.logCounter("TTISuccessCountForTwisterUpdate")}).catch(function(a){c.logCounter("TTIFailureCountForTwisterUpdate")})};this.postData=function(){var a=this.scopeName,c=this.customPageTypeId,k=this.customTags;b.ajax({url:this.url,dataType:"text",timeout:4E4,error:function(){},success:function(b,f,e){b=b.trim();ues("id",a,b);this.requestIdAvailable=!0;var h;void 0!==c&&(h=g.ue_pti,g.ue_pti=c);if(void 0!==k)for(b=0;b<k.length;b++)ue.tag(k[b]);uex("ld",a);void 0!==
c&&(g.ue_pti=h)}})};var l=this;this.markers={image:{conditions:1,handler:function(){uet("ne",f);l.signalMarker("af")}},af:{conditions:Twister.atfMarkerCount?Twister.atfMarkerCount:2,handler:function(){e.trigger("PageRefresh:ATF");uet("af",f);uet("cf",f);l.signalMarker("cf");n.updateCriticalFeatures();l.markClickToCI()}},cf:{conditions:Twister.cfMarkerCount?Twister.cfMarkerCount:2,handler:function(){e.trigger("PageRefresh:CF");uet("cf",f);l.postData()}}}}});d.when("A","jQuery","alt-page-refresh-ajax-scope").register("alt-page-refresh-measurement",
function(e,h,n){return function(c,b,f){this.atfMarker=b;this.cfMarker=f;this.scopeCount={};this.ajaxScopes={};this.url="";this.init=function(a,c,b){this.url="/gp/twister/dynamic-update/ajax-measurement.html/?s\x3d"+a+"\x26pgid\x3d"+c+"\x26deviceType\x3d"+Twister.deviceType+"\x26triggerEvent\x3d"+b;Twister.isInstaTwisterEnabled&&(this.url+="\x26ptd\x3d"+Twister.productTypeName)};this.start=function(a,b,f,e,h,d){if(g.ue){this.scopeCount[a]||(this.scopeCount[a]=0);var r=a+(this.scopeCount[a]+1);this.scopeCount[a]++;
var u=this.url;b&&(u+="\x26dimensionType\x3d"+b);"undefined"!==typeof f&&(u+="\x26dimensionCount\x3d"+f);"undefined"!==typeof e&&(u+="\x26dimensionsDisplayType\x3d"+e);this.ajaxScopes[a]=new n(c,r,u,h,d)}};this.stampImageLoad=function(a){this.ajaxScopes[a]&&(this.ajaxScopes[a].signalMarker("image"),Twister.cfImageLongPollTag&&this.ajaxScopes[a].addlongPoleTag("cf",Twister.cfImageLongPollTag))};this.stampFeature=function(a,b){this.ajaxScopes[b]&&(a===this.atfMarker&&this.ajaxScopes[b].signalMarker("af"),
a===this.cfMarker&&(this.ajaxScopes[b].signalMarker("cf"),Twister.cfHtmlLongPollTag&&this.ajaxScopes[b].addlongPoleTag("cf",Twister.cfHtmlLongPollTag)))};this.stampCustomMetrics=function(a,b){this.ajaxScopes[b]&&uet(a,this.ajaxScopes[b].scopeName)}}});d.when("A","ready","page-refresh-js-init-dpx-data","page-refresh-js-init-mason-data").register("page-refresh-state",function(e,h,d,c){function b(){var a=f.extend(!0,{},d.divToUpdateData,c.divToUpdateData),b={};e.each(a,function(a,c){b[c]=[];e.each(a,
function(a){(a=a.divToUpdate)&&b[c].push(a)})});return b}var f=e.$,a=e.state("page-refresh-data-mason"),k=e.state("page-refresh-data-dpx"),g=e.state("detail-page-device-type"),l={};"undefined"===typeof g&&(g=e.state("page-refresh-device-type"));return{fetchPageRefreshData:function(){var c=a&&a.pageRefreshUrlParams?a.pageRefreshUrlParams:{},e=k&&k.pageRefreshUrlParams?k.pageRefreshUrlParams:{};l.pageRefreshUrlParams={};f.extend(!0,l.pageRefreshUrlParams,c,e);"undefined"!==typeof g&&(l.deviceType=g.deviceType);
l.divToUpdateData=b();return l}}});d.when("A","jQuery","page-refresh-utils","cache").register("web-ajax-utility",function(e,h,d,c){function b(a,b,c,f,e){this.scope=a;this.url=b;this.options=c;this.useCustomRefreshBehavior=e;this.status=0;this.selected=!1;this.error=this.successData=this.xhr=this._status=void 0;this.chunks=[];this.doNotAbort=f||!1}var f=new c;b._objects={};b.prototype._initializeChunks=function(){var a=!1;f.exists(this.url)&&(a=!0,this.chunks=f.get(this.url));return a};b.prototype._callback=
function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);"function"===typeof a&&a.apply(self,b)};b.prototype._canAbort=function(){return!this.doNotAbort&&1===this.status};b.prototype._isAborted=function(){return 3===this.status};b.prototype._getUrl=function(){return this.url};b.prototype._abort=function(){if(1===this.status)try{this.ajaxRequestRefence.abort(),this.status=3}catch(b){var a={message:"Could not abort ajax request. "};"string"===typeof b&&(a.message+=b,b=void 0);a.logLevel=
"FATAL";g.ueLogError&&g.ueLogError(b,a)}};b.prototype._flushChunkData=function(){var a=this;a.chunks.length&&h.map(a.chunks,function(b){a.useCustomRefreshBehavior||d.refreshFeature(b);a._callback(a.options.chunk,b)})};b.prototype._request=function(){var a=this;a.ajaxRequestRefence=e.get(a.url,{params:a.options.params,success:function(b,c,h){a.status=4;a.successData=b;a._status=c;a.xhr=h;f.put(a.url,a.chunks);a.chunks=[];a.selected&&(a.useCustomRefreshBehavior||d.removeOverlayForAllFeatures(),a._callback(a.options.success,
b,c,h));e.trigger("PageRefresh:Success")},error:function(b,c,f){a.status=2;a.xhr=b;a._status=c;a.error=f;a.selected&&(a.useCustomRefreshBehavior||d.removeOverlayForAllFeatures(),a._callback(a.options.error,b,c,f))},abort:function(b){a.status=3;a.xhr=b;a.selected&&a._callback(a.options.abort,b)},chunk:function(b){b&&(a.chunks.push(b),a.selected&&(a.useCustomRefreshBehavior||d.refreshFeature(b),a._callback(a.options.chunk,b)))},timeout:a.options.timeout||4E4})};b.prototype.getContent=function(){b._abortRequestsExcept(this);
this.selected=!0;var a=this._initializeChunks();a&&(this.status=4);0===this.status?(this.status=1,this._request()):1===this.status?this._flushChunkData():4===this.status&&(a?(this._flushChunkData(),this.useCustomRefreshBehavior||d.removeOverlayForAllFeatures(),this._callback(this.options.success,this.successData,this._status,this.xhr),e.trigger("a:pageUpdate"),e.trigger("PageRefresh:Success")):(this.status=1,this._request()))};b._abortRequestsExcept=function(a){h.each(b._objects[a.scope],function(b,
c){c._canAbort()&&b!==a._getUrl()&&c._abort()})};b.getInstance=function(a,c,f,e,h){if(!a||!c||"object"!==typeof f)throw"Incorrect parameter passed.";h=h||!1;b._objects[a]=b._objects[a]||{};var d=b._objects[a][c];d&&d._isAborted()&&(delete b._objects[a][c],d=void 0);d||(b._objects[a][c]=new b(a,c,f,e,h,this));return b._objects[a][c]};return b});d.when("A").register("state-aware-critical-features",function(e){return function(){var e=[];this.add=function(d,c){for(var b=d.featureName,f=!1,a=0;a<e.length;a++)if(e[a].featureName===
b){f=!0;break}if(f)throw"Critical Feature "+d.featureName+" already registered for State Aware Messaging!";d={};d.featureName=b;d.callback=c;e.push(d)};this.getAllCriticalFeatures=function(){return e}}});d.when("A","state-aware-parameter-handler").register("state-aware-feature-consolidator",function(e,d){return{getStateAwareParameters:function(){return d.getStateAwareParameters()}}});d.when("A","state-aware-critical-features","state-aware-parameters").register("state-aware-parameter-handler",function(e,
d,n){return new function(){var c=new d,b=new n;this.registerCriticalFeature=function(b,a){try{if("function"===typeof a)c.add(b,a);else throw"callback needs to be a function!";}catch(e){g.ueLogError&&g.ueLogError(e,{logLevel:"ERROR",attribution:b.featureName,message:"StateAwareExceptionMessaging:- This error is caused by the feature "+b.featureName+" while registering itself as a critical feature for State Aware Messaging. "+e})}};this.getStateAwareParameters=function(){for(var f=c.getAllCriticalFeatures(),
a=0;a<f.length;a++){var e=f[a],d=e.featureName,e=e.callback.apply();try{b.putParameters(d,e)}catch(h){g.ueLogError&&g.ueLogError(h,{logLevel:"ERROR",attribution:d,message:"StateAwareMessaging:- This error is caused by the feature "+d+" while injecting state aware parameters. "+h})}}return b.getAllStateAwareParameters()}}});d.when("A").register("state-aware-parameters",function(){return function(){var e={};this.putParameters=function(d,g){var c=!0;for(feature in e)if(e.hasOwnProperty(feature)&&d!==
feature){var b=this.getParameters(feature);if(c){var c=g,f=!1;for(paramKey in c)if(c.hasOwnProperty(paramKey)&&b.hasOwnProperty(paramKey)){f=!0;break}c=!f}}if(c)for(paramKey in g)g.hasOwnProperty(paramKey)&&(b=g[paramKey],e[d]||(e[d]={}),e[d][paramKey]=b);else throw"Duplicate Parameters found for other Critical Feature!";};this.getParameters=function(d){return e[d]};this.getAllStateAwareParameters=function(){var d={},g;for(g in e)if(e.hasOwnProperty(g)){var c=this.getParameters(g),b;for(b in c)c.hasOwnProperty(b)&&
(d[b]=c[b])}return d}}});d.when("A").register("page-refresh-utils",function(d){var h=d.$,n={intermediateEOS:1,EOS:1};return{fadeInFeatures:function(c){h.each(c,function(b,a){"#"!==a[0]&&(c[b]="#"+a)});var b=c.join(",");h(b).addClass("js-feature-refresh-overlay");h(b).css("opacity",.5)},refreshFeature:function(c){var b=c.Value;c=c.FeatureName;if(!n[c]){var d,a;try{c&&b&&b.content&&(a=b.content[c],"undefined"!==typeof a&&(d=h("#"+c),d.html(a),d.removeClass("js-feature-refresh-overlay"),d.css("opacity",
"")))}catch(e){b={message:"Error in feature"+(c||"NoFeatureName"),logLevel:"FATAL"},g.ueLogError&&g.ueLogError(e,b)}}},removeOverlayForAllFeatures:function(c){c=h("body").find(".js-feature-refresh-overlay");for(var b=0;b<c.length;b++){var d=c[b];h(d).removeClass("js-feature-refresh-overlay");h(d).css("opacity","")}}}})});